cmake_minimum_required(VERSION 3.15)
project(SimpleTest)

# 检查是否在Emscripten环境下
if(NOT EMSCRIPTEN)
  message(FATAL_ERROR "请使用'emcmake cmake -G \"MinGW Makefiles\" -C CMakeLists_simple.txt ..'调用此文件")
endif()

message(STATUS "Emscripten环境检测成功")
message(STATUS "EMSCRIPTEN_VERSION_MAJOR: ${EMSCRIPTEN_VERSION_MAJOR}")
message(STATUS "EMSCRIPTEN_VERSION_MINOR: ${EMSCRIPTEN_VERSION_MINOR}")
message(STATUS "EMSCRIPTEN_VERSION_PATCH: ${EMSCRIPTEN_VERSION_PATCH}")

# 创建简单的源文件
file(WRITE ${CMAKE_CURRENT_BINARY_DIR}/simple_test.cpp 
"#include <iostream>
int main() {
    std::cout << \"Hello from Emscripten CMake Test!\" << std::endl;
    return 0;
}")

# 设置输出后缀为.html
set(CMAKE_EXECUTABLE_SUFFIX ".html")

# 添加可执行文件
add_executable(simple_test ${CMAKE_CURRENT_BINARY_DIR}/simple_test.cpp)

# 设置Emscripten特定标志
set_target_properties(simple_test PROPERTIES
    COMPILE_FLAGS "-s WASM=1"
    LINK_FLAGS "-s WASM=1"
)

message(STATUS "配置完成：使用'emmake make'构建") 